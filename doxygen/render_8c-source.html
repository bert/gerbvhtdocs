<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>gerbv: src/render.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_0fba06f62092f0c8d9ff47b96507f331.html">src</a>
  </div>
</div>
<div class="contents">
<h1>render.c</h1><a href="render_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * gEDA - GNU Electronic Design Automation</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * render.c -- this file is a part of gerbv.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> *   Copyright (C) 2007 Stuart Brorson (SDB@cloud9.net)</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * $Id$</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00011"></a>00011 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00012"></a>00012 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00013"></a>00013 <span class="comment"> * (at your option) any later version.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00016"></a>00016 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00017"></a>00017 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00018"></a>00018 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00021"></a>00021 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00022"></a>00022 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111 USA</span>
<a name="l00023"></a>00023 <span class="comment"> */</span>
<a name="l00024"></a>00024 
<a name="l00030"></a>00030 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;config.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="preprocessor">#ifdef HAVE_STDLIB_H</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#endif</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 <span class="preprocessor">#ifdef HAVE_STRING_H</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#endif</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>
<a name="l00042"></a>00042 <span class="preprocessor">#ifdef HAVE_UNISTD_H</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#endif</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00046"></a>00046 <span class="preprocessor">#ifdef HAVE_LIBGEN_H</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#include &lt;libgen.h&gt;</span> <span class="comment">/* dirname */</span>
<a name="l00048"></a>00048 <span class="preprocessor">#endif</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#include "<a class="code" href="gerbv_8h.html" title="The main header file for the libgerbv library.">gerbv.h</a>"</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include "<a class="code" href="main_8h.html" title="Header info for common structs and functions used for the GUI application.">main.h</a>"</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include "<a class="code" href="callbacks_8h.html" title="Header info for the GUI callback functions.">callbacks.h</a>"</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include "<a class="code" href="interface_8h.html" title="Header info for the GUI building functions for Gerber Viewer.">interface.h</a>"</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include "<a class="code" href="render_8h.html" title="Header info for the rendering support functions for libgerbv.">render.h</a>"</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#ifdef RENDER_USING_GDK</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor">  #include "<a class="code" href="draw-gdk_8h.html" title="Header info for the GDK rendering functions.">draw-gdk.h</a>"</span>
<a name="l00060"></a>00060 <span class="preprocessor">#else</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">  #ifdef WIN32</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;cairo-win32.h&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">  #else</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;cairo-xlib.h&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">  #endif</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span><span class="preprocessor">  #include &lt;cairo.h&gt;</span>
<a name="l00067"></a>00067 <span class="preprocessor">  #include "<a class="code" href="draw-gdk_8h.html" title="Header info for the GDK rendering functions.">draw-gdk.h</a>"</span>
<a name="l00068"></a>00068 <span class="preprocessor">  #include "<a class="code" href="draw_8h.html" title="Header info for the cairo rendering functions and the related selection calculating...">draw.h</a>"</span>
<a name="l00069"></a>00069 <span class="preprocessor">#endif</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00071"></a>00071 <span class="preprocessor">#define dprintf if(DEBUG) printf</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>
<a name="l00076"></a>00076 <span class="keyword">extern</span> gerbv_screen_t <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="keyword">extern</span> <a class="code" href="structgerbv__render__info__t.html">gerbv_render_info_t</a> screenRenderInfo;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="comment">/*</span>
<a name="l00081"></a>00081 <span class="comment">static void</span>
<a name="l00082"></a>00082 <span class="comment">render_layer_to_cairo_target_without_transforming(cairo_t *cr, gerbv_fileinfo_t *fileInfo, gerbv_render_info_t *renderInfo );</span>
<a name="l00083"></a>00083 <span class="comment">*/</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00086"></a>00086 <span class="keywordtype">void</span>
<a name="l00087"></a>00087 render_zoom_display (gint zoomType, gdouble scaleFactor, gdouble mouseX, gdouble mouseY) {
<a name="l00088"></a>00088        <span class="keywordtype">double</span> us_midx, us_midy;    <span class="comment">/* unscaled translation for screen center */</span>
<a name="l00089"></a>00089        <span class="keywordtype">int</span> half_w, half_h;         <span class="comment">/* cache for half window dimensions */</span>
<a name="l00090"></a>00090        gdouble mouseCoordinateX = 0.0;
<a name="l00091"></a>00091        gdouble mouseCoordinateY = 0.0;
<a name="l00092"></a>00092        <span class="keywordtype">double</span> oldWidth, oldHeight;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094        half_w = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> / 2;
<a name="l00095"></a>00095        half_h = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> / 2;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097        oldWidth = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> / screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>;
<a name="l00098"></a>00098        oldHeight = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> / screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>;
<a name="l00099"></a>00099        <span class="keywordflow">if</span> (zoomType == ZOOM_IN_CMOUSE || zoomType == ZOOM_OUT_CMOUSE) {
<a name="l00100"></a>00100               <span class="comment">/* calculate what user coordinate the mouse is pointing at */</span>
<a name="l00101"></a>00101               mouseCoordinateX = mouseX / screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> + screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a>;
<a name="l00102"></a>00102               mouseCoordinateY = (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> - mouseY) /
<a name="l00103"></a>00103                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> + screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a>;
<a name="l00104"></a>00104        }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106        us_midx = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a> + (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> / 2.0 )/
<a name="l00107"></a>00107                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>;
<a name="l00108"></a>00108        us_midy = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a> + (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> / 2.0 )/
<a name="l00109"></a>00109                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>;            
<a name="l00110"></a>00110 
<a name="l00111"></a>00111        <span class="keywordflow">switch</span>(zoomType) {
<a name="l00112"></a>00112               <span class="keywordflow">case</span> ZOOM_IN : <span class="comment">/* Zoom In */</span>
<a name="l00113"></a>00113               <span class="keywordflow">case</span> ZOOM_IN_CMOUSE : <span class="comment">/* Zoom In Around Mouse Pointer */</span>
<a name="l00114"></a>00114                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> += screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>/3;
<a name="l00115"></a>00115                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> += screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>/3;
<a name="l00116"></a>00116                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a> += (oldWidth - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> /
<a name="l00117"></a>00117                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>)) / 2.0;
<a name="l00118"></a>00118                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a> += (oldHeight - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> /
<a name="l00119"></a>00119                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>)) / 2.0;    
<a name="l00120"></a>00120                      <span class="keywordflow">break</span>;
<a name="l00121"></a>00121               <span class="keywordflow">case</span> ZOOM_OUT :  <span class="comment">/* Zoom Out */</span>
<a name="l00122"></a>00122               <span class="keywordflow">case</span> ZOOM_OUT_CMOUSE : <span class="comment">/* Zoom Out Around Mouse Pointer */</span>
<a name="l00123"></a>00123                      <span class="keywordflow">if</span> ((screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> &gt; 10)&amp;&amp;(screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> &gt; 10)) {
<a name="l00124"></a>00124                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> -= screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>/3;
<a name="l00125"></a>00125                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> -= screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>/3;
<a name="l00126"></a>00126                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a> += (oldWidth - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> /
<a name="l00127"></a>00127                                    screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>)) / 2.0;
<a name="l00128"></a>00128                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a> += (oldHeight - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> /
<a name="l00129"></a>00129                                    screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>)) / 2.0;
<a name="l00130"></a>00130                      }
<a name="l00131"></a>00131                      <span class="keywordflow">break</span>;
<a name="l00132"></a>00132               <span class="keywordflow">case</span> ZOOM_FIT : <span class="comment">/* Zoom Fit */</span>
<a name="l00133"></a>00133                      <a class="code" href="gerbv_8c.html#c4a1b93b36ae9b6cbda1da4441bf087d" title="Calculate the zoom and translations to fit the rendered scene inside the given scene...">gerbv_render_zoom_to_fit_display</a> (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>, &amp;screenRenderInfo);
<a name="l00134"></a>00134                      <span class="keywordflow">break</span>;
<a name="l00135"></a>00135               <span class="keywordflow">case</span> ZOOM_SET : <span class="comment">/*explicit scale set by user */</span>
<a name="l00136"></a>00136                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> = scaleFactor;
<a name="l00137"></a>00137                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> = scaleFactor;
<a name="l00138"></a>00138                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a> += (oldWidth - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> /
<a name="l00139"></a>00139                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>)) / 2.0;
<a name="l00140"></a>00140                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a> += (oldHeight - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> /
<a name="l00141"></a>00141                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>)) / 2.0;
<a name="l00142"></a>00142                     <span class="keywordflow">break</span>;
<a name="l00143"></a>00143               <span class="keywordflow">default</span> :
<a name="l00144"></a>00144                      GERB_MESSAGE(<span class="stringliteral">"Illegal zoom direction %d\n"</span>, zoomType);
<a name="l00145"></a>00145        }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147        <span class="keywordflow">if</span> (zoomType == ZOOM_IN_CMOUSE || zoomType == ZOOM_OUT_CMOUSE) {
<a name="l00148"></a>00148               <span class="comment">/* make sure the mouse is still pointing at the point calculated earlier */</span>
<a name="l00149"></a>00149               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a> = mouseCoordinateX - mouseX / screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>;
<a name="l00150"></a>00150               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a> = mouseCoordinateY - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> - mouseY) /
<a name="l00151"></a>00151                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>;
<a name="l00152"></a>00152        }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154        render_refresh_rendered_image_on_screen();
<a name="l00155"></a>00155        <span class="keywordflow">return</span>;
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 <span class="comment">/* --------------------------------------------------------- */</span>
<a name="l00165"></a>00165 <span class="keywordtype">void</span>
<a name="l00166"></a><a class="code" href="render_8h.html#4b44ecdfc48a84c018e3529f9a2da5a8">00166</a> <a class="code" href="render_8c.html#4b44ecdfc48a84c018e3529f9a2da5a8" title="Will determine the outline of the zoomed regions.">render_calculate_zoom_from_outline</a>(GtkWidget *widget, GdkEventButton *event)
<a name="l00167"></a>00167 {
<a name="l00168"></a>00168        <span class="keywordtype">int</span> x1, y1, x2, y2, dx, dy; <span class="comment">/* Zoom outline (UR and LL corners) */</span>
<a name="l00169"></a>00169        <span class="keywordtype">double</span> centerPointX, centerPointY;
<a name="l00170"></a>00170        <span class="keywordtype">int</span> half_x, half_y;         <span class="comment">/* cache for half window dimensions */</span>
<a name="l00171"></a>00171 
<a name="l00172"></a>00172        x1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, event-&gt;x);
<a name="l00173"></a>00173        y1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, event-&gt;y);
<a name="l00174"></a>00174        x2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, event-&gt;x);
<a name="l00175"></a>00175        y2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, event-&gt;y);
<a name="l00176"></a>00176        dx = x2-x1;
<a name="l00177"></a>00177        dy = y2-y1;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179        <span class="keywordflow">if</span> ((dx &gt;= 4) &amp;&amp; (dy &gt;= 4)) {
<a name="l00180"></a>00180               <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.centered_outline_zoom) {
<a name="l00181"></a>00181                      <span class="comment">/* Centered outline mode */</span>
<a name="l00182"></a>00182                      x1 = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x - dx;
<a name="l00183"></a>00183                      y1 = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y - dy;
<a name="l00184"></a>00184                      dx *= 2;
<a name="l00185"></a>00185                      dy *= 2;
<a name="l00186"></a>00186               }
<a name="l00187"></a>00187               half_x = (x1+x2)/2;
<a name="l00188"></a>00188               half_y = (y1+y2)/2;
<a name="l00189"></a>00189               centerPointX = half_x/screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> + screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a>;
<a name="l00190"></a>00190               centerPointY = (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> - half_y)/screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> +
<a name="l00191"></a>00191                             screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a>;
<a name="l00192"></a>00192               
<a name="l00193"></a>00193               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a> *= MIN(((<span class="keywordtype">double</span>)screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> / dx),
<a name="l00194"></a>00194                                                  ((<span class="keywordtype">double</span>)screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> / dy));
<a name="l00195"></a>00195               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a> = screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>;
<a name="l00196"></a>00196               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#71983cbd44f96fba693f200e7dbd5416">lowerLeftX</a> = centerPointX - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a> /
<a name="l00197"></a>00197                                    2.0 / screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>);
<a name="l00198"></a>00198               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#0f7fb11737241af0fdc2e6e5b8c95327">lowerLeftY</a> = centerPointY - (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a> /
<a name="l00199"></a>00199                                    2.0 / screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>);                          
<a name="l00200"></a>00200        }
<a name="l00201"></a>00201        render_refresh_rendered_image_on_screen();
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00205"></a>00205 <span class="keywordtype">void</span>
<a name="l00206"></a>00206 render_draw_selection_box_outline(<span class="keywordtype">void</span>) {
<a name="l00207"></a>00207        GdkGC *gc;
<a name="l00208"></a>00208        GdkGCValues values;
<a name="l00209"></a>00209        GdkGCValuesMask values_mask;
<a name="l00210"></a>00210        gint x1, y1, x2, y2, dx, dy;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212        memset(&amp;values, 0, <span class="keyword">sizeof</span>(values));
<a name="l00213"></a>00213        values.function = GDK_XOR;
<a name="l00214"></a>00214        <span class="keywordflow">if</span> (!<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color.pixel)
<a name="l00215"></a>00215               gdk_colormap_alloc_color(gdk_colormap_get_system(), &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color, FALSE, TRUE);
<a name="l00216"></a>00216        values.foreground = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color;
<a name="l00217"></a>00217        values_mask = GDK_GC_FUNCTION | GDK_GC_FOREGROUND;
<a name="l00218"></a>00218        gc = gdk_gc_new_with_values(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, &amp;values, values_mask);
<a name="l00219"></a>00219        
<a name="l00220"></a>00220        x1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x);
<a name="l00221"></a>00221        y1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00222"></a>00222        x2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x);
<a name="l00223"></a>00223        y2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00224"></a>00224        dx = x2-x1;
<a name="l00225"></a>00225        dy = y2-y1;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227        gdk_draw_rectangle(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, gc, FALSE, x1, y1, dx, dy);
<a name="l00228"></a>00228        gdk_gc_unref(gc);
<a name="l00229"></a>00229 }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 <span class="comment">/* --------------------------------------------------------- */</span>
<a name="l00232"></a>00232 <span class="keywordtype">void</span>
<a name="l00233"></a>00233 render_draw_zoom_outline(gboolean centered)
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235        GdkGC *gc;
<a name="l00236"></a>00236        GdkGCValues values;
<a name="l00237"></a>00237        GdkGCValuesMask values_mask;
<a name="l00238"></a>00238        gint x1, y1, x2, y2, dx, dy;
<a name="l00239"></a>00239 
<a name="l00240"></a>00240        memset(&amp;values, 0, <span class="keyword">sizeof</span>(values));
<a name="l00241"></a>00241        values.function = GDK_XOR;
<a name="l00242"></a>00242        <span class="keywordflow">if</span> (!<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color.pixel)
<a name="l00243"></a>00243               gdk_colormap_alloc_color(gdk_colormap_get_system(), &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color, FALSE, TRUE);
<a name="l00244"></a>00244        values.foreground = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color;
<a name="l00245"></a>00245        values_mask = GDK_GC_FUNCTION | GDK_GC_FOREGROUND;
<a name="l00246"></a>00246        gc = gdk_gc_new_with_values(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, &amp;values, values_mask);
<a name="l00247"></a>00247        
<a name="l00248"></a>00248        x1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x);
<a name="l00249"></a>00249        y1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00250"></a>00250        x2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x);
<a name="l00251"></a>00251        y2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00252"></a>00252        dx = x2-x1;
<a name="l00253"></a>00253        dy = y2-y1;
<a name="l00254"></a>00254 
<a name="l00255"></a>00255        <span class="keywordflow">if</span> (centered) {
<a name="l00256"></a>00256               <span class="comment">/* Centered outline mode */</span>
<a name="l00257"></a>00257               x1 = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x - dx;
<a name="l00258"></a>00258               y1 = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y - dy;
<a name="l00259"></a>00259               dx *= 2;
<a name="l00260"></a>00260               dy *= 2;
<a name="l00261"></a>00261               x2 = x1+dx;
<a name="l00262"></a>00262               y2 = y1+dy;
<a name="l00263"></a>00263        }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265        gdk_draw_rectangle(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, gc, FALSE, x1, y1, dx, dy);
<a name="l00266"></a>00266        gdk_gc_unref(gc);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268        <span class="comment">/* Draw actual zoom area in dashed lines */</span>
<a name="l00269"></a>00269        memset(&amp;values, 0, <span class="keyword">sizeof</span>(values));
<a name="l00270"></a>00270        values.function = GDK_XOR;
<a name="l00271"></a>00271        values.foreground = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color;
<a name="l00272"></a>00272        values.line_style = GDK_LINE_ON_OFF_DASH;
<a name="l00273"></a>00273        values_mask = GDK_GC_FUNCTION | GDK_GC_FOREGROUND | GDK_GC_LINE_STYLE;
<a name="l00274"></a>00274        gc = gdk_gc_new_with_values(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, &amp;values,
<a name="l00275"></a>00275                             values_mask);
<a name="l00276"></a>00276        
<a name="l00277"></a>00277        <span class="keywordflow">if</span> ((dy == 0) || ((<span class="keywordtype">double</span>)dx/dy &gt; (<span class="keywordtype">double</span>)<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;allocation.width/
<a name="l00278"></a>00278                             <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;allocation.height)) {
<a name="l00279"></a>00279               dy = dx * (double)<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;allocation.height/
<a name="l00280"></a>00280                      <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;allocation.width;
<a name="l00281"></a>00281        } 
<a name="l00282"></a>00282        <span class="keywordflow">else</span> {
<a name="l00283"></a>00283               dx = dy * (double)<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;allocation.width/
<a name="l00284"></a>00284                      <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;allocation.height;
<a name="l00285"></a>00285        }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287        gdk_draw_rectangle(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, gc, FALSE, (x1+x2-dx)/2,
<a name="l00288"></a>00288               (y1+y2-dy)/2, dx, dy);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290        gdk_gc_unref(gc);
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00298"></a>00298 <span class="keywordtype">void</span>
<a name="l00299"></a><a class="code" href="render_8h.html#af5154df95883609a5f634defc8a8d73">00299</a> <a class="code" href="render_8c.html#af5154df95883609a5f634defc8a8d73" title="Displays a measured distance graphically on screen and in statusbar.">render_draw_measure_distance</a>(<span class="keywordtype">void</span>)
<a name="l00300"></a>00300 {
<a name="l00301"></a>00301 <span class="preprocessor">#if !defined (__MINGW32__) </span>
<a name="l00302"></a>00302 <span class="preprocessor"></span>
<a name="l00303"></a>00303        GdkGC *gc;
<a name="l00304"></a>00304        GdkGCValues values;
<a name="l00305"></a>00305        GdkGCValuesMask values_mask;
<a name="l00306"></a>00306 <span class="preprocessor">#endif   </span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>       gint x1, y1, x2, y2;
<a name="l00308"></a>00308        <span class="keywordtype">double</span> dx, dy;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 <span class="preprocessor">#if !defined (__MINGW32__) </span><span class="comment">/*taken out because of different drawing behaviour under win32 resulting in a smear */</span>
<a name="l00311"></a>00311        memset(&amp;values, 0, <span class="keyword">sizeof</span>(values));
<a name="l00312"></a>00312        values.function = GDK_XOR;
<a name="l00313"></a>00313        <span class="keywordflow">if</span> (!<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color.pixel)
<a name="l00314"></a>00314               gdk_colormap_alloc_color(gdk_colormap_get_system(), &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color, FALSE, TRUE);
<a name="l00315"></a>00315        values.foreground = <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.zoom_outline_color;
<a name="l00316"></a>00316        values_mask = GDK_GC_FUNCTION | GDK_GC_FOREGROUND;
<a name="l00317"></a>00317        gc = gdk_gc_new_with_values(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, &amp;values,
<a name="l00318"></a>00318                             values_mask);
<a name="l00319"></a>00319 <span class="preprocessor">#endif</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span>       x1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x);
<a name="l00321"></a>00321        y1 = MIN(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00322"></a>00322        x2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x);
<a name="l00323"></a>00323        y2 = MAX(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00324"></a>00324        dx = (x2 - x1)/ screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>;
<a name="l00325"></a>00325        dy = (y2 - y1)/ screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>;
<a name="l00326"></a>00326     
<a name="l00327"></a>00327 <span class="preprocessor">#if !defined (__MINGW32__)</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span>       gdk_draw_line(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, gc, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_x,
<a name="l00329"></a>00329                 <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.start_y, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_x, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.last_y);
<a name="l00330"></a>00330 <span class="preprocessor">#endif</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span>       <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.win.lastMeasuredX = dx;
<a name="l00332"></a>00332        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.win.lastMeasuredY = dy;
<a name="l00333"></a>00333        callbacks_update_statusbar_measured_distance (dx, dy);
<a name="l00334"></a>00334 <span class="preprocessor">#if !defined (__MINGW32__)</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>       gdk_gc_unref(gc);
<a name="l00336"></a>00336 <span class="preprocessor">#endif     </span>
<a name="l00337"></a>00337 <span class="preprocessor"></span>} <span class="comment">/* draw_measure_distance */</span>
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00340"></a>00340 <span class="keywordtype">void</span> render_selection_layer (<span class="keywordtype">void</span>){
<a name="l00341"></a>00341 <span class="preprocessor">#ifndef RENDER_USING_GDK</span>
<a name="l00342"></a>00342 <span class="preprocessor"></span>       cairo_t *cr;
<a name="l00343"></a>00343        
<a name="l00344"></a>00344        <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionRenderData) 
<a name="l00345"></a>00345               cairo_surface_destroy ((cairo_surface_t *) <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionRenderData);
<a name="l00346"></a>00346        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionRenderData = 
<a name="l00347"></a>00347               (gpointer) cairo_surface_create_similar ((cairo_surface_t *)<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.windowSurface,
<a name="l00348"></a>00348               CAIRO_CONTENT_COLOR_ALPHA, screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a>,
<a name="l00349"></a>00349               screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a>);
<a name="l00350"></a>00350        <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type != <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce7e442f58229590aad8ec1a39afd4e01ce">GERBV_SELECTION_EMPTY</a>) {
<a name="l00351"></a>00351               cr= cairo_create(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionRenderData);
<a name="l00352"></a>00352               gerbv_render_cairo_set_scale_and_translation(cr, &amp;screenRenderInfo);
<a name="l00353"></a>00353               cairo_set_source_rgba (cr, 1.0, 1.0, 1.0, 0.85);
<a name="l00354"></a>00354               <span class="comment">/* for now, assume everything in the selection buffer is from one image */</span>
<a name="l00355"></a>00355               <a class="code" href="structgerbv__image__t.html">gerbv_image_t</a> *matchImage;
<a name="l00356"></a>00356               <span class="keywordtype">int</span> j;
<a name="l00357"></a>00357               <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray-&gt;len &gt; 0) {
<a name="l00358"></a>00358                      gerbv_selection_item_t sItem = g_array_index (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray,
<a name="l00359"></a>00359                                    gerbv_selection_item_t, 0);
<a name="l00360"></a>00360                      matchImage = (<a class="code" href="structgerbv__image__t.html">gerbv_image_t</a> *) sItem.image;      
<a name="l00361"></a>00361                      dprintf(<span class="stringliteral">"    .... calling render_image_to_cairo_target on selection layer...\n"</span>);
<a name="l00362"></a>00362                      <span class="keywordflow">for</span>(j = <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#bab05758e52aca9b2b2c171ec923a4bf">max_files</a>-1; j &gt;= 0; j--) {
<a name="l00363"></a>00363                             <span class="keywordflow">if</span> ((<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[j]) &amp;&amp; (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[j]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a> == matchImage)) {
<a name="l00364"></a>00364                                    draw_image_to_cairo_target (cr, <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[j]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a>,
<a name="l00365"></a>00365                                           <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[j]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#145b4c98b74e7b07d262e5ecad32199e">transform</a>.<a class="code" href="structgerbv__user__transformation__t.html#4c5d3155d0f4aa77896b1f88535cbb4e">inverted</a>,
<a name="l00366"></a>00366                                           1.0/MAX(screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>,
<a name="l00367"></a>00367                                           screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>),
<a name="l00368"></a>00368                                           DRAW_SELECTIONS, &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo);
<a name="l00369"></a>00369                             }
<a name="l00370"></a>00370                      }
<a name="l00371"></a>00371               }
<a name="l00372"></a>00372               cairo_destroy (cr);
<a name="l00373"></a>00373        }
<a name="l00374"></a>00374 <span class="preprocessor">#endif</span>
<a name="l00375"></a>00375 <span class="preprocessor"></span>}
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00378"></a>00378 <span class="keywordtype">void</span> render_refresh_rendered_image_on_screen (<span class="keywordtype">void</span>) {
<a name="l00379"></a>00379        GdkCursor *cursor;
<a name="l00380"></a>00380        
<a name="l00381"></a>00381        dprintf(<span class="stringliteral">"----&gt; Entering redraw_pixmap...\n"</span>);
<a name="l00382"></a>00382        cursor = gdk_cursor_new(GDK_WATCH);
<a name="l00383"></a>00383        gdk_window_set_cursor(GDK_WINDOW(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window), cursor);
<a name="l00384"></a>00384        gdk_cursor_destroy(cursor);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386        <span class="keywordflow">if</span> (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#902b5d841ab7a246a3ffa4fd2a6a9d26">renderType</a> &lt; 2){
<a name="l00387"></a>00387            <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.pixmap) 
<a name="l00388"></a>00388               gdk_pixmap_unref(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.pixmap);
<a name="l00389"></a>00389            <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.pixmap = gdk_pixmap_new(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.drawing_area-&gt;window, screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a>,
<a name="l00390"></a>00390            screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a>, -1);
<a name="l00391"></a>00391            gerbv_render_to_pixmap_using_gdk (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>, <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.pixmap, &amp;screenRenderInfo, &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo,
<a name="l00392"></a>00392                      &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selection_color);   
<a name="l00393"></a>00393            dprintf(<span class="stringliteral">"&lt;---- leaving redraw_pixmap.\n"</span>);
<a name="l00394"></a>00394        }
<a name="l00395"></a>00395 <span class="preprocessor">#ifndef RENDER_USING_GDK</span>
<a name="l00396"></a>00396 <span class="preprocessor"></span>       <span class="keywordflow">else</span>{
<a name="l00397"></a>00397            <span class="keywordtype">int</span> i;
<a name="l00398"></a>00398            dprintf(<span class="stringliteral">"    .... Now try rendering the drawing using cairo .... \n"</span>);
<a name="l00399"></a>00399            <span class="comment">/* </span>
<a name="l00400"></a>00400 <span class="comment">            * This now allows drawing several layers on top of each other.</span>
<a name="l00401"></a>00401 <span class="comment">            * Higher layer numbers have higher priority in the Z-order.</span>
<a name="l00402"></a>00402 <span class="comment">            */</span>
<a name="l00403"></a>00403            <span class="keywordflow">for</span>(i = <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#bab05758e52aca9b2b2c171ec923a4bf">max_files</a>-1; i &gt;= 0; i--) {
<a name="l00404"></a>00404               <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]) {
<a name="l00405"></a>00405                   cairo_t *cr;
<a name="l00406"></a>00406                   <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#e8bbf3f82c3b6c36ae32a2e6b524cbcb">privateRenderData</a>) 
<a name="l00407"></a>00407                      cairo_surface_destroy ((cairo_surface_t *) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#e8bbf3f82c3b6c36ae32a2e6b524cbcb">privateRenderData</a>);
<a name="l00408"></a>00408                   <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#e8bbf3f82c3b6c36ae32a2e6b524cbcb">privateRenderData</a> = 
<a name="l00409"></a>00409                      (gpointer) cairo_surface_create_similar ((cairo_surface_t *)<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.windowSurface,
<a name="l00410"></a>00410                      CAIRO_CONTENT_COLOR_ALPHA, screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a>,
<a name="l00411"></a>00411                      screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a>);
<a name="l00412"></a>00412                   cr= cairo_create(<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#e8bbf3f82c3b6c36ae32a2e6b524cbcb">privateRenderData</a> );
<a name="l00413"></a>00413                   <a class="code" href="gerbv_8c.html#fda4267bf9cd1e1f69976cf6320a43b7" title="Render a layer to a cairo context.">gerbv_render_layer_to_cairo_target</a> (cr, <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i], &amp;screenRenderInfo);
<a name="l00414"></a>00414                   dprintf(<span class="stringliteral">"    .... calling render_image_to_cairo_target on layer %d...\n"</span>, i);                 
<a name="l00415"></a>00415                   cairo_destroy (cr);
<a name="l00416"></a>00416               }
<a name="l00417"></a>00417            }
<a name="l00418"></a>00418            <span class="comment">/* render the selection layer */</span>
<a name="l00419"></a>00419            render_selection_layer();
<a name="l00420"></a>00420            
<a name="l00421"></a>00421            render_recreate_composite_surface ();
<a name="l00422"></a>00422        }
<a name="l00423"></a>00423 <span class="preprocessor">#endif</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span>       <span class="comment">/* remove watch cursor and switch back to normal cursor */</span>
<a name="l00425"></a>00425        callbacks_switch_to_correct_cursor ();
<a name="l00426"></a>00426        callbacks_force_expose_event_for_screen();
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00430"></a>00430 <span class="preprocessor">#ifndef RENDER_USING_GDK</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>gint
<a name="l00432"></a>00432 render_create_cairo_buffer_surface () {
<a name="l00433"></a>00433        <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface) {
<a name="l00434"></a>00434               cairo_surface_destroy (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface);
<a name="l00435"></a>00435               <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface = NULL;
<a name="l00436"></a>00436        }
<a name="l00437"></a>00437        <span class="keywordflow">if</span> (!<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.windowSurface)
<a name="l00438"></a>00438               <span class="keywordflow">return</span> 0;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface= cairo_surface_create_similar ((cairo_surface_t *)<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.windowSurface,
<a name="l00441"></a>00441                                            CAIRO_CONTENT_COLOR, screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#c1f647d0380e07c39a350f21a37e7a5c">displayWidth</a>,
<a name="l00442"></a>00442                                            screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#465fcc1f9e903179b0f44ac028ad7dbc">displayHeight</a>);
<a name="l00443"></a>00443        <span class="keywordflow">return</span> 1;
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00447"></a>00447 <span class="keywordtype">void</span>
<a name="l00448"></a>00448 render_clear_selection_buffer (<span class="keywordtype">void</span>){
<a name="l00449"></a>00449   <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type == <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce7e442f58229590aad8ec1a39afd4e01ce">GERBV_SELECTION_EMPTY</a>)
<a name="l00450"></a>00450     <span class="keywordflow">return</span>;
<a name="l00451"></a>00451 
<a name="l00452"></a>00452   g_array_remove_range (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray, 0,
<a name="l00453"></a>00453                      <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray-&gt;len);
<a name="l00454"></a>00454   <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type = <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce7e442f58229590aad8ec1a39afd4e01ce">GERBV_SELECTION_EMPTY</a>;
<a name="l00455"></a>00455 }
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00458"></a>00458 <span class="keywordtype">void</span>
<a name="l00459"></a>00459 render_find_selected_objects_and_refresh_display (gint activeFileIndex, gboolean eraseOldSelection){
<a name="l00460"></a>00460        <span class="comment">/* clear the old selection array if desired */</span>
<a name="l00461"></a>00461        <span class="keywordflow">if</span> ((eraseOldSelection)&amp;&amp;(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray-&gt;len))
<a name="l00462"></a>00462               g_array_remove_range (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray, 0,
<a name="l00463"></a>00463                      <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray-&gt;len);
<a name="l00464"></a>00464 
<a name="l00465"></a>00465        <span class="comment">/* make sure we have a bufferSurface...if we start up in FAST mode, we may not</span>
<a name="l00466"></a>00466 <span class="comment">          have one yet, but we need it for selections */</span>
<a name="l00467"></a>00467        <span class="keywordflow">if</span> (!render_create_cairo_buffer_surface())
<a name="l00468"></a>00468               <span class="keywordflow">return</span>;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470        <span class="comment">/* call draw_image... passing the FILL_SELECTION mode to just search for</span>
<a name="l00471"></a>00471 <span class="comment">          nets which match the selection, and fill the selection buffer with them */</span>
<a name="l00472"></a>00472        cairo_t *cr= cairo_create(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface); 
<a name="l00473"></a>00473        gerbv_render_cairo_set_scale_and_translation(cr,&amp;screenRenderInfo);
<a name="l00474"></a>00474        draw_image_to_cairo_target (cr, <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[activeFileIndex]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a>, <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[activeFileIndex]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#145b4c98b74e7b07d262e5ecad32199e">transform</a>.<a class="code" href="structgerbv__user__transformation__t.html#4c5d3155d0f4aa77896b1f88535cbb4e">inverted</a>,
<a name="l00475"></a>00475               1.0/MAX(screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#2323896b8bb588ad34fb404cd808bfa1">scaleFactorX</a>, screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#f55b7a0baaf4614a54d67858e48e9347">scaleFactorY</a>),
<a name="l00476"></a>00476               FIND_SELECTIONS, &amp;<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo);
<a name="l00477"></a>00477        cairo_destroy (cr);
<a name="l00478"></a>00478        <span class="comment">/* if the selection array is empty, switch the "mode" to empty to make it</span>
<a name="l00479"></a>00479 <span class="comment">          easier to check if it is holding anything */</span>
<a name="l00480"></a>00480        <span class="keywordflow">if</span> (!<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.selectedNodeArray-&gt;len)
<a name="l00481"></a>00481               <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type = <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce7e442f58229590aad8ec1a39afd4e01ce">GERBV_SELECTION_EMPTY</a>;
<a name="l00482"></a>00482        <span class="comment">/* re-render the selection buffer layer */</span>
<a name="l00483"></a>00483        <span class="keywordflow">if</span> (screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#902b5d841ab7a246a3ffa4fd2a6a9d26">renderType</a> &lt; 2){
<a name="l00484"></a>00484               render_refresh_rendered_image_on_screen ();
<a name="l00485"></a>00485        }
<a name="l00486"></a>00486        <span class="keywordflow">else</span> {
<a name="l00487"></a>00487               render_selection_layer();
<a name="l00488"></a>00488               render_recreate_composite_surface ();
<a name="l00489"></a>00489               callbacks_force_expose_event_for_screen();
<a name="l00490"></a>00490        }
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00494"></a>00494 <span class="keywordtype">void</span>
<a name="l00495"></a>00495 render_fill_selection_buffer_from_mouse_click (gint mouseX, gint mouseY, gint activeFileIndex,
<a name="l00496"></a>00496               gboolean eraseOldSelection) {
<a name="l00497"></a>00497        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.lowerLeftX = mouseX;
<a name="l00498"></a>00498        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.lowerLeftY = mouseY;
<a name="l00499"></a>00499        <span class="comment">/* no need to populate the upperright coordinates for a point_click */</span>
<a name="l00500"></a>00500        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type = <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce710e126364356096db8de382be6500a9b">GERBV_SELECTION_POINT_CLICK</a>;
<a name="l00501"></a>00501        render_find_selected_objects_and_refresh_display (activeFileIndex, eraseOldSelection);
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00505"></a>00505 <span class="keywordtype">void</span>
<a name="l00506"></a>00506 render_fill_selection_buffer_from_mouse_drag (gint corner1X, gint corner1Y,
<a name="l00507"></a>00507        gint corner2X, gint corner2Y, gint activeFileIndex, gboolean eraseOldSelection) {
<a name="l00508"></a>00508        <span class="comment">/* figure out the lower left corner of the box */</span>
<a name="l00509"></a>00509        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.lowerLeftX = MIN(corner1X, corner2X);
<a name="l00510"></a>00510        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.lowerLeftY = MIN(corner1Y, corner2Y);
<a name="l00511"></a>00511        <span class="comment">/* figure out the upper right corner of the box */</span>
<a name="l00512"></a>00512        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.upperRightX = MAX(corner1X, corner2X);
<a name="l00513"></a>00513        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.upperRightY = MAX(corner1Y, corner2Y);
<a name="l00514"></a>00514        
<a name="l00515"></a>00515        <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type = <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce7887013a8452c6617dbb1d588ee1a1a89">GERBV_SELECTION_DRAG_BOX</a>;
<a name="l00516"></a>00516        render_find_selected_objects_and_refresh_display (activeFileIndex, eraseOldSelection);
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00520"></a>00520 <span class="keywordtype">void</span> render_recreate_composite_surface () {
<a name="l00521"></a>00521        gint i;
<a name="l00522"></a>00522        
<a name="l00523"></a>00523        <span class="keywordflow">if</span> (!render_create_cairo_buffer_surface())
<a name="l00524"></a>00524               <span class="keywordflow">return</span>;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526        cairo_t *cr= cairo_create(<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface);
<a name="l00527"></a>00527        <span class="comment">/* fill the background with the appropriate color */</span>
<a name="l00528"></a>00528        cairo_set_source_rgba (cr, (<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#545040772fbe22865784f8ddca0a3d5d">background</a>.red/G_MAXUINT16,
<a name="l00529"></a>00529               (<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#545040772fbe22865784f8ddca0a3d5d">background</a>.green/G_MAXUINT16,
<a name="l00530"></a>00530               (<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#545040772fbe22865784f8ddca0a3d5d">background</a>.blue/G_MAXUINT16, 1);
<a name="l00531"></a>00531        cairo_paint (cr);
<a name="l00532"></a>00532        
<a name="l00533"></a>00533        <span class="keywordflow">for</span>(i = <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#bab05758e52aca9b2b2c171ec923a4bf">max_files</a>-1; i &gt;= 0; i--) {
<a name="l00534"></a>00534               <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i] &amp;&amp; <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#fc59b2ffc535696e81b3086d025370c5">isVisible</a>) {
<a name="l00535"></a>00535                      cairo_set_source_surface (cr, (cairo_surface_t *) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#e8bbf3f82c3b6c36ae32a2e6b524cbcb">privateRenderData</a>,
<a name="l00536"></a>00536                                                    0, 0);
<a name="l00537"></a>00537                      <span class="comment">/* ignore alpha if we are in high-speed render mode */</span>
<a name="l00538"></a>00538                      <span class="keywordflow">if</span> (((<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#00d1a74686e09a34d72cfeb357a1004d">alpha</a> &lt; 65535)&amp;&amp;(screenRenderInfo.<a class="code" href="structgerbv__render__info__t.html#902b5d841ab7a246a3ffa4fd2a6a9d26">renderType</a> != 1)) {
<a name="l00539"></a>00539                             cairo_paint_with_alpha(cr,(<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#00d1a74686e09a34d72cfeb357a1004d">alpha</a>/G_MAXUINT16);
<a name="l00540"></a>00540                      }
<a name="l00541"></a>00541                      <span class="keywordflow">else</span> {
<a name="l00542"></a>00542                             cairo_paint (cr);
<a name="l00543"></a>00543                      }
<a name="l00544"></a>00544               }
<a name="l00545"></a>00545        }
<a name="l00546"></a>00546        <span class="comment">/* render the selection layer at the end */</span>
<a name="l00547"></a>00547        <span class="keywordflow">if</span> (<a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionInfo.type != <a class="code" href="gerbv_8h.html#91d08347e830450bb1b3d8593c89fce7e442f58229590aad8ec1a39afd4e01ce">GERBV_SELECTION_EMPTY</a>) {
<a name="l00548"></a>00548               cairo_set_source_surface (cr, (cairo_surface_t *) <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.selectionRenderData,
<a name="l00549"></a>00549                                                    0, 0);
<a name="l00550"></a>00550               cairo_paint_with_alpha (cr,1.0);
<a name="l00551"></a>00551        }
<a name="l00552"></a>00552        cairo_destroy (cr);
<a name="l00553"></a>00553 }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555 <span class="comment">/* ------------------------------------------------------ */</span>
<a name="l00556"></a>00556 <span class="keywordtype">void</span> render_project_to_cairo_target (cairo_t *cr) {
<a name="l00557"></a>00557        <span class="comment">/* fill the background with the appropriate color */</span>
<a name="l00558"></a>00558        cairo_set_source_rgba (cr, (<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#545040772fbe22865784f8ddca0a3d5d">background</a>.red/G_MAXUINT16,
<a name="l00559"></a>00559               (<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#545040772fbe22865784f8ddca0a3d5d">background</a>.green/G_MAXUINT16,
<a name="l00560"></a>00560               (<span class="keywordtype">double</span>) <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#545040772fbe22865784f8ddca0a3d5d">background</a>.blue/G_MAXUINT16, 1);
<a name="l00561"></a>00561        cairo_paint (cr);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563        cairo_set_source_surface (cr, (cairo_surface_t *) <a class="code" href="callbacks_8c.html#1ec55bca5ad7868d265ee62fe10a29bc" title="Global variable to keep track of what&amp;#39;s happening on the screen.">screen</a>.bufferSurface, 0 , 0);
<a name="l00564"></a>00564                                                    
<a name="l00565"></a>00565        cairo_paint (cr);
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 <span class="preprocessor">#endif  </span><span class="comment">/* RENDER_USING_GDK */</span>
<a name="l00568"></a>00568 
<a name="l00569"></a>00569 <span class="comment">/* ------------------------------------------------------------------ */</span>
<a name="l00573"></a>00573 <a class="code" href="structgerbv__stats__t.html">gerbv_stats_t</a> *
<a name="l00574"></a><a class="code" href="render_8h.html#889cc7c2416f0b74e06688336759d383">00574</a> <a class="code" href="render_8c.html#889cc7c2416f0b74e06688336759d383">generate_gerber_analysis</a>(<span class="keywordtype">void</span>)
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576        <span class="keywordtype">int</span> i;
<a name="l00577"></a>00577        <a class="code" href="structgerbv__stats__t.html">gerbv_stats_t</a> *stats;
<a name="l00578"></a>00578        <a class="code" href="structgerbv__stats__t.html">gerbv_stats_t</a> *instats;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580        <span class="comment">/* Create new stats structure to hold report for whole project </span>
<a name="l00581"></a>00581 <span class="comment">       * (i.e. all layers together) */</span>
<a name="l00582"></a>00582        stats = <a class="code" href="gerb__stats_8c.html#5616195ffdb5915a0db83250296b3d79" title="Allocates a new gerbv_stats structure.">gerbv_stats_new</a>();
<a name="l00583"></a>00583 
<a name="l00584"></a>00584        <span class="comment">/* Loop through open layers and compile statistics by accumulating reports from each layer */</span>
<a name="l00585"></a>00585        <span class="keywordflow">for</span> (i = 0; i &lt;= <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#bab05758e52aca9b2b2c171ec923a4bf">max_files</a>-1; i++) {
<a name="l00586"></a>00586               <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i] &amp;&amp; <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#fc59b2ffc535696e81b3086d025370c5">isVisible</a> &amp;&amp;
<a name="l00587"></a>00587                             (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a>-&gt;<a class="code" href="structgerbv__image__t.html#1989b1e87fa2e8a13cd0ab7fd449a158">layertype</a> == <a class="code" href="gerbv_8h.html#ff1f9c1b35a7164a5d5cc4f15090f40b75512ef4a42645cafd74dbed3cb6994d">GERBV_LAYERTYPE_RS274X</a>) ) {
<a name="l00588"></a>00588                      instats = <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a>-&gt;<a class="code" href="structgerbv__image__t.html#0d803a4e74d2247e3029b21eda386558">gerbv_stats</a>;
<a name="l00589"></a>00589                      <a class="code" href="gerb__stats_8c.html#6764e0c2e4177d9a2d94d6b0b343b031">gerbv_stats_add_layer</a>(stats, instats, i+1);
<a name="l00590"></a>00590               }
<a name="l00591"></a>00591        }
<a name="l00592"></a>00592        <span class="keywordflow">return</span> stats;
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 <span class="comment">/* ------------------------------------------------------------------ */</span>
<a name="l00600"></a>00600 <a class="code" href="structgerbv__drill__stats__t.html">gerbv_drill_stats_t</a> *
<a name="l00601"></a><a class="code" href="render_8h.html#ffb3214e7c9e9351093ff329c3be389a">00601</a> <a class="code" href="render_8c.html#ffb3214e7c9e9351093ff329c3be389a">generate_drill_analysis</a>(<span class="keywordtype">void</span>)
<a name="l00602"></a>00602 {
<a name="l00603"></a>00603        <span class="keywordtype">int</span> i;
<a name="l00604"></a>00604        <a class="code" href="structgerbv__drill__stats__t.html">gerbv_drill_stats_t</a> *stats;
<a name="l00605"></a>00605        <a class="code" href="structgerbv__drill__stats__t.html">gerbv_drill_stats_t</a> *instats;
<a name="l00606"></a>00606 
<a name="l00607"></a>00607        stats = <a class="code" href="drill__stats_8c.html#ee54e8c844abf30383ba3145415c8cbb" title="Allocates a new drill_stats structure.">gerbv_drill_stats_new</a>();
<a name="l00608"></a>00608 
<a name="l00609"></a>00609        <span class="comment">/* Loop through open layers and compile statistics by accumulating reports from each layer */</span>
<a name="l00610"></a>00610        <span class="keywordflow">for</span>(i = <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#bab05758e52aca9b2b2c171ec923a4bf">max_files</a>-1; i &gt;= 0; i--) {
<a name="l00611"></a>00611               <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i] &amp;&amp; 
<a name="l00612"></a>00612                             <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#fc59b2ffc535696e81b3086d025370c5">isVisible</a> &amp;&amp;
<a name="l00613"></a>00613                             (<a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a>-&gt;<a class="code" href="structgerbv__image__t.html#1989b1e87fa2e8a13cd0ab7fd449a158">layertype</a> == <a class="code" href="gerbv_8h.html#ff1f9c1b35a7164a5d5cc4f15090f40bd998fc87d25a728f35b2e0d9145b64ce">GERBV_LAYERTYPE_DRILL</a>) ) {
<a name="l00614"></a>00614                      instats = <a class="code" href="main_8c.html#8d078d012e6d279c43966b2121226c43" title="Global state variable to keep track of what&amp;#39;s happening on the screen.">mainProject</a>-&gt;<a class="code" href="structgerbv__project__t.html#3ecaa11fbc1cef45f458e2b88445ac35">file</a>[i]-&gt;<a class="code" href="structgerbv__fileinfo__t.html#0aec7123b754ed7cb0adc9c98e985f84">image</a>-&gt;<a class="code" href="structgerbv__image__t.html#911cb23ad6a1b5e4a10903a761982d89">drill_stats</a>;
<a name="l00615"></a>00615                      <span class="comment">/* add this batch of stats.  Send the layer </span>
<a name="l00616"></a>00616 <span class="comment">                     * index for error reporting */</span>
<a name="l00617"></a>00617                      <a class="code" href="drill__stats_8c.html#d56fda8432b9fd7f9657f3f74df9d0f6">gerbv_drill_stats_add_layer</a>(stats, instats, i+1);
<a name="l00618"></a>00618               }
<a name="l00619"></a>00619        }
<a name="l00620"></a>00620        <span class="keywordflow">return</span> stats;
<a name="l00621"></a>00621 }
<a name="l00622"></a>00622 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Aug 19 00:14:49 2008 for gerbv by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
